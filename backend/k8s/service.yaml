# AutoDeployX Kubernetes Service
# NodePort service for Minikube access

apiVersion: v1
kind: Service
metadata:
  name: autodeployx-service
  namespace: default
  labels:
    app: autodeployx-app
spec:
  type: NodePort
  selector:
    app: autodeployx-app
  ports:
  - name: http
    protocol: TCP
    port: 80
    targetPort: 8000
    nodePort: 30080

---
# ConfigMap for application configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: autodeployx-config
  namespace: default
data:
  app.yaml: |
    server:
      host: 0.0.0.0
      port: 8000
    logging:
      level: INFO
      format: json
    features:
      metrics_enabled: true
      tracing_enabled: true

---
# Secret for sensitive data
# NOTE: In production, use kubectl create secret or external secrets manager
# DO NOT commit actual secrets to git - use placeholders
apiVersion: v1
kind: Secret
metadata:
  name: autodeployx-secrets
  namespace: default
type: Opaque
stringData:
  # Replace these placeholders with actual values during deployment
  database-url: "postgresql://autodeployx:${DB_PASSWORD}@postgres:5432/autodeployx"
  redis-url: "redis://redis:6379/0"

---
# Namespace
apiVersion: v1
kind: Namespace
metadata:
  name: autodeployx
  labels:
    name: autodeployx
